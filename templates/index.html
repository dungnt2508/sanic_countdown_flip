<!DOCTYPE html>
 <html lang="en">
 <head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <meta http-equiv="X-UA-Compatible" content="ie=edge">
     <title>Chiến dịch 2M</title>
     <link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap" rel="stylesheet">
     <link rel="stylesheet" href="./static/style.css">
	 <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>

 </head>
 <body>
    <div id="campain_2m">
		<h1>Chiến Dịch 2M</h1>
         <div id="box_count">
             <div>
                 <span id="box">{{ totalContract }}</span>
	             <span id="current_time">{{ current_time }}</span>
             </div>
         </div>
     </div>
 </body>
<script>


    function get_box() {
         var box = document.getElementById("box");
         $.ajax({
		        url: "/get_count",
		        type: "GET",
		        dataType: "json",
		        success: function(resp){
		            console.log(resp)
		            box.innerHTML = resp.newTotalContract
		        },
		        error: function(resp){
		            console.log(resp)
		        }
		    })
     }
     function get_time() {
         var current_time = document.getElementById("current_time");
         var today = new Date();
         var month = today.getMonth()+1;
		 var hours = today.getHours();
		 var minutes = today.getMinutes();
		 var seconds = today.getSeconds();
		 if (month < "10") { month = "0" + month; }
		 if (hours < "10") { hours = "0" + hours; }
		 if (minutes < "10") { minutes = "0" + minutes; }
		 if (seconds < "10") { seconds = "0" + seconds; }
         var date = today.getDate() + '/' + month + '/' + today.getFullYear() + ' ' + hours + ":" + minutes + ":" + seconds;
         current_time.innerHTML = date
     }
    var countdown_box = setInterval(get_box, 15000);
    var current_time = setInterval(get_time, 1000);
 </script>
 </html>